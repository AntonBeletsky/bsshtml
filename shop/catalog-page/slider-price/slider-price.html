<!DOCTYPE html>
<html data-bs-theme="light" lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>boostrap-lux-shop-master</title>
    <link rel="stylesheet" href="../../../assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@200;300;400;500;600;700&amp;display=swap">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto+Slab:300,400|Roboto:300,400,700">
    <link rel="stylesheet" href="../../../assets/css/basket.css">
    <link rel="stylesheet" href="../../../assets/css/compare-page.css">
    <link rel="stylesheet" href="../../../assets/css/featured-Itemn.css">
    <link rel="stylesheet" href="../../../assets/css/img.css">
    <link rel="stylesheet" href="../../../assets/css/order-item.css">
    <link rel="stylesheet" href="../../../assets/css/popover-content.css">
    <link rel="stylesheet" href="../../../assets/css/product-card-grid.css">
    <link rel="stylesheet" href="../../../assets/css/product-card-list.css">
    <link rel="stylesheet" href="../../../assets/css/product-page.css">
    <link rel="stylesheet" href="../../../assets/css/shadow-box.css">
    <link rel="stylesheet" href="../../../assets/css/slider-price.css">
    <link rel="stylesheet" href="../../../assets/css/stars-rating.css">
    <link rel="stylesheet" href="../../../assets/css/tech-shadow-box.css">
    <link rel="stylesheet" href="../../../assets/css/timeline.css">
    <link rel="stylesheet" href="../../../assets/css/ui-collapsible-panel.css">
    <link rel="stylesheet" href="../../../assets/css/ui-icons-circle.css">
    <link rel="stylesheet" href="../../../assets/css/wishlist.css">
<!-- Подключение стилей Font Awesome для иконок -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" integrity="sha512-5A8nwdMOWrSz20fDsjczgUidUBR8liPYU+WymTZP1lmY9G6Oc7HlZv156XqnsgNUzTyMefFTcsFH/tnJE/+xBg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<!-- Подключение стилей Material Icons от Google для использования иконок -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!-- Подключение библиотеки jQuery для облегчения манипуляций с DOM и работы с событиями -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<!-- Подключение стилей Fotorama для создания галерей изображений -->
<link  href="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.css" rel="stylesheet">

<!-- Подключение библиотеки Fotorama для создания галерей изображений -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/fotorama/4.6.4/fotorama.js"></script>

<!-- Подключение Bootstrap JavaScript для поддержки интерактивных компонентов Bootstrap -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/5.3.0/js/bootstrap.min.js"></script>

<!-- Подключение библиотеки Popper.js для управления всплывающими элементами (такими как тултипы и выпадающие меню) -->
<script src="https://unpkg.com/@popperjs/core@2/dist/umd/popper.js"></script>
</head>

<body><div class="slider-container-old container-fluid">
    <div class="row mt-2">
        <div class="col">
            <h5>Filter By Price</h5>
        </div>
    </div>
    <div class="row mt-2 px-2">
        <div class="col">
            <div class="slider-track" id="slider-track">
                <div class="slider-range" id="slider-range"></div>
                <div class="slider-thumb slider-thumb-left" id="slider-thumb-left" style="left: 0%;">
                </div>
                <div class="slider-thumb slider-thumb-right" id="slider-thumb-right" style="left: 100%;">
                </div>
            </div>
        </div>
    </div>

    <div class="row mt-4">
        <div class="col">
            <div class="d-flex align-items-center gap-2">
                <input type="text" id="input-left" placeholder="Min price" class="form-control">
                <input type="text" id="input-right" placeholder="Max price" class="form-control">
                <button class="btn btn-primary" id="btn-apply">Apply</button>
            </div>
        </div>
    </div>
</div>


<code style="display: none;">
    // API using simulation
function getMaxPrice() {
  /* you request to API here */
  const maxPrice = 1000;
  return maxPrice;
}

// API using simulation
function getMinPrice() {
  /* you request to API here */
  const minPrice = 0;
  return minPrice;
}

// API using simulation
const minPrice = getMinPrice();
const maxPrice = getMaxPrice();

/* price range */
const priceRange = maxPrice - minPrice;

/* get html elements - btns */
const sliderThumbLeft = document.getElementById("slider-thumb-left");
const sliderThumbRight = document.getElementById("slider-thumb-right");

/* get html elements - range & track  */
const sliderTrack = document.getElementById("slider-track");
const sliderRange = document.getElementById("slider-range");

/* text inputs for price input */
const inputLeft = document.getElementById("input-left");
const inputRight = document.getElementById("input-right");

/* drow Slider */
function updateSlider() {
  /* get values from btns  */
  let leftValue = parseFloat(sliderThumbLeft.style.left);
  let rightValue = parseFloat(sliderThumbRight.style.left);

  /* проверка на выход за диапазон */
  if (leftValue < 0) {
    sliderThumbLeft.style.left = "0%";
  }

  if (rightValue > 100) {
    sliderThumbRight.style.left = "100%";
  }

  /* calculate price track to price */
  const minValue = minPrice + Math.round((priceRange * leftValue) / 100);
  const maxValue = minPrice + Math.round((priceRange * rightValue) / 100);

  /* data */
  inputLeft.value = `${minValue}`;
  inputRight.value = `${maxValue}`;

  /* checkrange */
  if (leftValue < 0) {
    leftValue = 0;
  }

  if (rightValue > 100) {
    rightValue = 100;
  }

  /* draws a range */
  sliderRange.style.left = leftValue + "%";
  sliderRange.style.width = rightValue - leftValue + "%";
}

/* mouse movement handling - обработка движения мыши */
function mouseMoveHandler(event, thumb, direction) {
  const sliderTrackRect = sliderTrack.getBoundingClientRect();
  let newPos =
    ((event.clientX - sliderTrackRect.left) / sliderTrackRect.width) * 100;

  if (newPos < 0) newPos = 0;
  if (newPos > 100) newPos = 100;
  if (direction === "left" && newPos >= parseFloat(sliderThumbRight.style.left))
    return;
  if (direction === "right" && newPos <= parseFloat(sliderThumbLeft.style.left))
    return;

  thumb.style.left = newPos + "%";
  updateSlider();
}

/* mouse click handling for left price btn */
sliderThumbLeft.onmousedown = function (event) {
  event.preventDefault();
  document.onmousemove = function (event) {
    mouseMoveHandler(event, sliderThumbLeft, "left");
  };
  document.onmouseup = function () {
    document.onmousemove = null;
    document.onmouseup = null;
  };
};

/* mouse click handling for right price btn */
sliderThumbRight.onmousedown = function (event) {
  event.preventDefault();
  document.onmousemove = function (event) {
    mouseMoveHandler(event, sliderThumbRight, "right");
  };
  document.onmouseup = function () {
    document.onmousemove = null;
    document.onmouseup = null;
  };
};

/* update drow slider */
updateSlider(); // Initial update

/* проверка на диапазон и выход за него */
function checkingMinMaxRange(whatCheck = "", variable_value, control_value) {
  if (isNaN(variable_value)) {
    console.log(" variable_value is not a number");
    return false;
  }

  if (variable_value < minPrice) {
    console.log("variable_value is less than minPrice");
    return false;
  }

  if (variable_value > maxPrice) {
    console.log("variable_value is more than maxPrice");
    return false;
  }

  /* передали левое значение, оно не должно быть больше или равно парвому*/
  if (whatCheck === "min") {
    if (variable_value >= control_value) {
      console.log("variable_value is more than control_value");
      return false;
    }
  }

  /* передали правое значение, оно не должно быть меньше или равно левому*/
  if (whatCheck === "max") {
    if (variable_value <= control_value) {
      console.log("variable_value is less than control_value");
      return false;
    }
  }

  console.log("checkingMinMaxRange is true");
  return true;
}

/* ввод инпута меняет ползунок */
inputLeft.addEventListener("input", (event) => {
  let value = parseInt(event.target.value, 10);

  if (!checkingMinMaxRange("min", value, parseInt(inputRight.value, 10))) {
    // value = minPrice;
  }

  const newLeft = ((value - minPrice) / priceRange) * 100;

  if (newLeft < parseFloat(sliderThumbRight.style.left)) {
    sliderThumbLeft.style.left = `${newLeft}%`;
    updateSlider();
  }
});

/* ввод инпута меняет ползунок */
inputRight.addEventListener("input", (event) => {
  let value = parseInt(event.target.value, 10);

  if (!checkingMinMaxRange("max", value, parseInt(inputLeft.value, 10))) {
    // value = maxPrice;
  }

  const newRight = ((value - minPrice) / priceRange) * 100;

  if (newRight > parseFloat(sliderThumbLeft.style.left)) {
    sliderThumbRight.style.left = `${newRight}%`;
    updateSlider();
  }
});

</code>
    <script src="../../../assets/js/jquery.min.js"></script>
    <script src="../../../assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="../../../assets/js/bs-init.js"></script>
    <script src="../../../assets/js/popovers.js"></script>
    <script src="../../../assets/js/slider-price.js"></script>
</body>

</html>